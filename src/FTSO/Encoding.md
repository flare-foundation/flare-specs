## FTSO Message Encoding Reference

## FeedValue

| **Field** | **Size (bytes)** | **Description**                      |
| --------- | ---------------- | ------------------------------------ |
| FeedValue | 4                | Encoded as Excess-2^31 (big-endian). |

## Commit

| **Field**  | **Size (bytes)** | **Description** |
| ---------- | ---------------- | --------------- |
| CommitHash | 32               | Hash of the feed values for the round |

The `CommitHash` is generated by applying the Keccak-256 hash function to the ABI-encoded tuple: `(submitAddress, round, random, feedValues)`.

## Reveal

| **Field**   | **Size (bytes)** | **Description**                     |
| ----------- | ---------------- | ----------------------------------- |
| RandomValue | 32               | Keccak-256 hash (big-endian).       |
| FeedValues  | Variable         | Encoded feed values (4 bytes each). |

`FeedValues` encodes an array of numeric values for the FTSO feeds, where each value is:
1. Converted to a 32-bit integer: $\text{int(round}(v \times 10^{d})\text{)}$, where $v$ is the feed value and $d$ is the number of decimals.
2. Offset by $2^{31}$ (Excess-2^31 encoding) to ensure all values are positive 32-bit unsigned integers.
3. Encoded as 4-byte big-endian unsigned integer.
4. If the feed value is undefined, it is encoded as four zero bytes (`0x00000000`).

All encoded feed values are then concatenated into a single byte array. As an optimization, trailing empty values can be truncated.
